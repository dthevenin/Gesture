import{isFunction,vsTestElem}from"vs_utils";var EVENT_SUPPORT_TOUCH=!1,hasPointer=window.navigator.pointerEnabled,hasMSPointer=window.navigator.msPointerEnabled;"undefined"!=typeof document&&"createTouch"in document?EVENT_SUPPORT_TOUCH=!0:hasPointer||hasMSPointer?EVENT_SUPPORT_TOUCH=!0:"undefined"!=typeof document&&window.navigator&&window.navigator.userAgent&&(-1===window.navigator.userAgent.indexOf("iPhone")&&-1===window.navigator.userAgent.indexOf("iPad")&&-1===window.navigator.userAgent.indexOf("Android")&&-1===window.navigator.userAgent.indexOf("BlackBerry")||(EVENT_SUPPORT_TOUCH=!0));var POINTER_START,POINTER_MOVE,POINTER_END,POINTER_CANCEL;EVENT_SUPPORT_TOUCH?(POINTER_START=hasPointer?"pointerdown":hasMSPointer?"MSPointerDown":"touchstart",POINTER_MOVE=hasPointer?"pointermove":hasMSPointer?"MSPointerMove":"touchmove",POINTER_END=hasPointer?"pointerup":hasMSPointer?"MSPointerUp":"touchend",POINTER_CANCEL=hasPointer?"pointercancel":hasMSPointer?"MSPointerCancel":"touchcancel"):(POINTER_START="mousedown",POINTER_MOVE="mousemove",POINTER_END="mouseup",POINTER_CANCEL=null);var MOUSE_ID$1=31337;class Pointer$1{constructor(e,n,t,r,i,o){this.configureWithEvent(e,r,i,o),this.type=n,this.identifier=t}configureWithEvent(e,n,t,r){this.pageX=e.pageX,this.pageY=e.pageY,"undefiend"!=typeof n&&(this.clientX=n),"undefiend"!=typeof t&&(this.clientY=t),e.target?this.target=e.target:r&&(this.target=r.target),e.currentTarget?this.currentTarget=e.currentTarget:r&&(this.currentTarget=r.currentTarget)}}var PointerTypes$1={TOUCH:2,PEN:3,MOUSE:4},pointerEvents=[];function buildTouchList(e,n){var t=[];e.nbPointers=e.touches.length;for(var r=0;r<e.nbPointers;r++){var i=e.touches[r],o=new Pointer$1(i,PointerTypes$1.TOUCH,i.identifier,i.clientX,i.clientY,e);t.push(o)}e.pointerList=t,t=[];for(r=0;r<e.targetTouches.length;r++){i=e.targetTouches[r];if(!n||pointerEvents[i.identifier]==n){o=new Pointer$1(i,PointerTypes$1.TOUCH,i.identifier,i.clientX,i.clientY,e);t.push(o)}}e.targetPointerList=t,t=[];for(r=0;r<e.changedTouches.length;r++){i=e.changedTouches[r],o=new Pointer$1(i,PointerTypes$1.TOUCH,i.identifier,e.clientX,e.clientY,e);t.push(o)}e.changedPointerList=t}function buildMouseList(e,n){var t=[];t.push(new Pointer$1(e,PointerTypes$1.MOUSE,MOUSE_ID$1,e.layerX,e.layerY)),n?(e.nbPointers=0,e.pointerList=[],e.targetPointerList=t,e.changedPointerList=t):(e.nbPointers=1,e.pointerList=t,e.targetPointerList=t,e.changedPointerList=[])}var all_pointers=[],removed_pointers=[];function buildMSPointerList(e,n,t){var r=[],i=[],o=[],s=e.pointerId,a=all_pointers[s];n?(a?(removed_pointers[s]=a,all_pointers[s]=void 0):(a=removed_pointers[s])||(a=new Pointer$1(e,e.pointerType,s,e.layerX,e.layerY),removed_pointers[s]=a),removed_pointers.forEach(function(e){e&&o.push(e)}),removed_pointers=[]):a?a.configureWithEvent(e):(a=new Pointer$1(e,e.pointerType,s,e.layerX,e.layerY),all_pointers[s]=a),all_pointers.forEach(function(e){e&&(r.push(e),t&&pointerEvents[e.identifier]!=t||i.push(e))}),e.nbPointers=r.length,e.pointerList=r,e.targetPointerList=i,e.changedPointerList=o}function mouseDownHandler(e,n){buildMouseList(e),n(e)}function mouseMoveHandler(e,n){buildMouseList(e),n(e)}function mouseUpHandler(e,n){buildMouseList(e,!0),n(e)}function touchStartHandler(e,n,t){for(var r,i=e.targetTouches.length,o=0;o<i;o++)r=e.targetTouches[o],pointerEvents[r.identifier]=t;buildTouchList(e),n(e)}function touchMoveHandler(e,n,t){buildTouchList(e,t),n(e)}function touchEndHandler(e,n){for(var t,r=e.changedTouches.length,i=0;i<r;i++)t=e.changedTouches[i],pointerEvents[t.identifier]=void 0;buildTouchList(e),n(e)}function touchCancelHandler(e,n){buildTouchList(e),n(e,n)}var nbPointerListener=0,msRemovePointer=function(e){var n=e.pointerId,t=all_pointers[n];t&&(removed_pointers[t.identifier]=t,all_pointers[t.identifier]=void 0),0===--nbPointerListener&&(document.removeEventListener(hasPointer?"pointerup":"MSPointerUp",msRemovePointer),document.removeEventListener(hasPointer?"pointercancel":"MSPointerCancel",msRemovePointer))};function msPointerDownHandler(e,n,t){pointerEvents[e.pointerId]=t,buildMSPointerList(e,!1,t),n(e),0===nbPointerListener&&(document.addEventListener(hasPointer?"pointerup":"MSPointerUp",msRemovePointer),document.addEventListener(hasPointer?"pointercancel":"MSPointerCancel",msRemovePointer)),nbPointerListener++}function msPointerMoveHandler(e,n,t){buildMSPointerList(e,!1,t),n(e)}function msPointerUpHandler(e,n){buildMSPointerList(e,!0),n(e)}function msPointerCancelHandler(e,n){buildMSPointerList(e,!0),n(e)}var pointerStartHandler$1,pointerMoveHandler$1,pointerEndHandler$1,pointerCancelHandler;EVENT_SUPPORT_TOUCH?hasMSPointer?(pointerStartHandler$1=msPointerDownHandler,pointerMoveHandler$1=msPointerMoveHandler,pointerEndHandler$1=msPointerUpHandler,pointerCancelHandler=msPointerCancelHandler):(pointerStartHandler$1=touchStartHandler,pointerMoveHandler$1=touchMoveHandler,pointerEndHandler$1=touchEndHandler,pointerCancelHandler=touchCancelHandler):(pointerStartHandler$1=mouseDownHandler,pointerMoveHandler$1=mouseMoveHandler,pointerEndHandler$1=mouseUpHandler,pointerCancelHandler=mouseUpHandler);function getBindingIndex(e,n,t){if(!n||!t||!t.__event_listeners)return-1;for(var r=0;r<t.__event_listeners.length;r++){var i=t.__event_listeners[r];if(i.target===e&&i.type===n&&i.listener===t)return r}return-1}function createUniqueId(){return""+(new Date).getTime()+Math.floor(1e6*Math.random())}function managePointerListenerAdd(e,n,t,r){var i=r.listener?r.listener.id:void 0;switch(i||(i=createUniqueId(),r.listener&&(r.listener.id=i)),n){case POINTER_START:return r.handler=function(e){pointerStartHandler$1(e,t,i)},!0;case POINTER_MOVE:return r.handler=function(e){pointerMoveHandler$1(e,t,i)},!0;case POINTER_END:return r.handler=function(e){pointerEndHandler$1(e,t)},!0;case POINTER_CANCEL:return r.handler=function(e){pointerCancelHandler(e,t)},!0}return!1}function managePointerListenerRemove(e,n,t){switch(n){case POINTER_START:case POINTER_MOVE:case POINTER_END:case POINTER_CANCEL:return!0}return!1}function addPointerListener(e,n,t,r){if(n)if(t){var i=t;if(isFunction(t)||(i=t.handleEvent,isFunction(i)&&(i=i.bind(t))),-1===getBindingIndex(e,n,t)){t.__event_listeners||(t.__event_listeners=[]);var o={target:e,type:n,listener:t};t.__event_listeners.push(o),managePointerListenerAdd(e,n,i,o)||manageGestureListenerAdd(e,n,i,o)||(o.handler=i),e.addEventListener(n,o.handler,r)}else console.error("addPointerListener binding already existing")}else console.error("addPointerListener no listener")}function removePointerListener(e,n,t,r){if(n)if(t){var i=getBindingIndex(e,n,t);if(-1!==i){var o=t.__event_listeners[i];t.__event_listeners.remove(i),managePointerListenerRemove(e,n,o)||manageGestureListenerRemove(e,n,o),e.removeEventListener(n,o.handler,r)}else console.error("removePointerListener no binding")}else console.error("removePointerListener no listener")}function createCustomEvent$1(e,n,t){var r=document.createEvent("Event");r.initEvent(e,!0,!0);for(var i in t)r[i]=t[i];n.dispatchEvent(r)}let GESTURE_START,GESTURE_CHANGE,GESTURE_END;const support={},events=["gesturestart","gesturechange","gestureend"];for(var el=document.createElement("div"),i=0;i<events.length;i++){var eventName=events[i],isSupported=(eventName="on"+eventName)in vsTestElem;isSupported||(vsTestElem.setAttribute(eventName,"return;"),isSupported="function"==typeof vsTestElem[eventName]),support[events[i]]=isSupported}support.gestures=support.gesturestart&&support.gesturechange&&support.gestureend,"MSGestureEvent"in window&&(support.msGestures=!0),support.gestures=!1,support.msGestures=!1,support.msGestures?(GESTURE_START="MSGestureStart",GESTURE_CHANGE="MSGestureChange",GESTURE_END="MSGestureEnd"):support.gestures?(GESTURE_START="gesturestart",GESTURE_CHANGE="gesturechange",GESTURE_END="gestureend"):(GESTURE_START="_gesture_start",GESTURE_CHANGE="_gesture_change",GESTURE_END="_gesture_end");export{createCustomEvent$1 as createCustomEvent,removePointerListener,addPointerListener,PointerTypes$1 as PointerTypes,Pointer$1 as Pointer,POINTER_START,POINTER_MOVE,POINTER_END,POINTER_CANCEL,GESTURE_START,GESTURE_CHANGE,GESTURE_END};
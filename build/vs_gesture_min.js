(function(){function m(a,c,b,d,e,E){this.configureWithEvent(a,d,e,E);this.type=c;this.identifier=b}function F(a,c){var b=[];a.nbPointers=a.touches.length;for(var d=0;d<a.nbPointers;d++){var e=a.touches[d],e=new m(e,o.TOUCH,e.identifier,e.clientX,e.clientY,a);b.push(e)}a.pointerList=b;b=[];for(d=0;d<a.targetTouches.length;d++)e=a.targetTouches[d],c&&v[e.identifier]!=c||(e=new m(e,o.TOUCH,e.identifier,e.clientX,e.clientY,a),b.push(e));a.targetPointerList=b;b=[];for(d=0;d<a.changedTouches.length;d++)e=
a.changedTouches[d],e=new m(e,o.TOUCH,e.identifier,a.clientX,a.clientY,a),b.push(e);a.changedPointerList=b}function M(a,c){var b=[];b.push(new m(a,o.MOUSE,R,a.layerX,a.layerY));c?(a.nbPointers=0,a.pointerList=[],a.targetPointerList=b,a.changedPointerList=b):(a.nbPointers=1,a.pointerList=b,a.targetPointerList=b,a.changedPointerList=[])}function G(a,c,b){var d=[],e=[],E=[],f=a.pointerId,g=p[f];c?(g?(q[f]=g,p[f]=void 0):(g=q[f],g||(g=new m(a,a.pointerType,f,a.layerX,a.layerY),q[f]=g)),q.forEach(function(a){a&&
E.push(a)}),q=[]):g?g.configureWithEvent(a):(g=new m(a,a.pointerType,f,a.layerX,a.layerY),p[f]=g);p.forEach(function(a){a&&(d.push(a),b&&v[a.identifier]!=b||e.push(a))});a.nbPointers=d.length;a.pointerList=d;a.targetPointerList=e;a.changedPointerList=E}function Y(a,c){M(a);c(a)}function Z(a,c){M(a);c(a)}function $(a,c){M(a,!0);c(a)}function aa(a,c,b){for(var d,e=a.targetTouches.length,f=0;f<e;f++)d=a.targetTouches[f],v[d.identifier]=b;F(a);c(a)}function ba(a,c,b){F(a,b);c(a)}function ca(a,c){for(var b,
d=a.changedTouches.length,e=0;e<d;e++)b=a.changedTouches[e],v[b.identifier]=void 0;F(a);c(a)}function da(a,c){F(a);c(a,c)}function ea(a,c,b){v[a.pointerId]=b;G(a,!1,b);c(a);0===H&&(document.addEventListener(k?"pointerup":"MSPointerUp",I),document.addEventListener(k?"pointercancel":"MSPointerCancel",I));H++}function fa(a,c,b){G(a,!1,b);c(a)}function ga(a,c){G(a,!0);c(a)}function ha(a,c){G(a,!0);c(a)}function S(a,c,b){if(!c||!b||!b.__event_listeners)return-1;for(var d=0;d<b.__event_listeners.length;d++){var e=
b.__event_listeners[d];if(e.target===a&&e.type===c&&e.listener===b)return d}return-1}function ia(a,c,b,d){var e=d.listener?d.listener.id:void 0;e||(e=""+(new Date).getTime()+""+Math.floor(1E6*Math.random()),d.listener&&(d.listener.id=e));switch(c){case w:return d.handler=function(a){x(a,b,e)},!0;case y:return d.handler=function(a){z(a,b,e)},!0;case A:return d.handler=function(a){B(a,b)},!0;case C:return d.handler=function(a){J(a,b)},!0}return!1}function n(a,c,b){var d=document.createEvent("Event");
d.initEvent(a,!0,!0);for(var e in b)d[e]=b[e];c.dispatchEvent(d)}function T(a,c){if(!a||!c)return 0;var b=c.pageX-a.pageX,d=c.pageY-a.pageY;return Math.sqrt(b*b+d*d)}function U(a,c){return!a||!c?0:180*Math.atan2(c.pageY-a.pageY,c.pageX-a.pageX)/Math.PI}function V(a){var c=a.length,b=0,d=0,e=0;if(0===c)return{X:0,y:0};for(;b<c;b++)var f=a[b],d=d+f.pageX,e=e+f.pageY;return{x:d/c-N.x,y:e/c-N.y}}function O(a){a.centroid={x:a.pageX,y:a.pageY};a.translation=[a.centroid.x-r.x,a.centroid.y-r.y];a.pointerList=
[new m(a,o.TOUCH,R)];a.targetPointerList=a.pointerList;a.nbPointers=1}function ja(a,c,b,d){var e=d.listener?d.listener.id:void 0;switch(c){case l:return d.gesture_handler=function(a){x(a,ka,e)},a.addEventListener(f.POINTER_START,d.gesture_handler),d.handler=b,!0;case h:case i:return d.handler=b,!0}return!1}function la(a,c,b,d){switch(c){case l:return d.handler=function(a){r={x:a.pageX,y:a.pageY};O(a);b(a)},!0;case h:return d.handler=function(a){O(a);b(a)},!0;case i:return d.handler=function(a){O(a);
b(a)},!0}return!1}function ma(a,c,b){var d=b.listener?b.listener.id:void 0;switch(c){case l:return a.removeEventListener(f.POINTER_START,b.gesture_handler,d),!0;case h:case i:return!0}return!1}function na(a,c){switch(c){case l:case h:case i:return!0}return!1}var f=this.vs=this.vs||{},s=f.util=f.util||{},g=!1,k=window.navigator.pointerEnabled,j=window.navigator.msPointerEnabled;if("undefined"!=typeof document&&"createTouch"in document)g=!0;else if(k||j)g=!0;else if("undefined"!=typeof document&&window.navigator&&
window.navigator.userAgent&&(-1!==window.navigator.userAgent.indexOf("Android")||-1!==window.navigator.userAgent.indexOf("BlackBerry")))g=!0;var w,y,A,C;g?(w=k?"pointerdown":j?"MSPointerDown":"touchstart",y=k?"pointermove":j?"MSPointerMove":"touchmove",A=k?"pointerup":j?"MSPointerUp":"touchend",C=k?"pointercancel":j?"MSPointerCancel":"touchcancel"):(w="mousedown",y="mousemove",A="mouseup",C=null);var R=31337;m.prototype.configureWithEvent=function(a,c,b,d){this.pageX=a.pageX;this.pageY=a.pageY;"undefiend"!==
typeof c&&(this.clientX=c);"undefiend"!==typeof b&&(this.clientY=b);a.target?this.target=a.target:d&&(this.target=d.target);a.currentTarget?this.currentTarget=a.currentTarget:d&&(this.currentTarget=d.currentTarget)};var o={TOUCH:2,PEN:3,MOUSE:4},v=[],p=[],q=[],H=0,I=function(a){if(a=p[a.pointerId])q[a.identifier]=a,p[a.identifier]=void 0;H--;0===H&&(document.removeEventListener(k?"pointerup":"MSPointerUp",I),document.removeEventListener(k?"pointercancel":"MSPointerCancel",I))},x,z,B,J;g?j?(x=ea,z=
fa,B=ga,J=ha):(x=aa,z=ba,B=ca,J=da):(x=Y,z=Z,J=B=$);f.createCustomEvent=n;f.removePointerListener=function(a,c,b,d){if(c)if(b){var e=S(a,c,b);if(-1===e)console.error("removePointerListener no binding");else{var f=b.__event_listeners[e];b.__event_listeners.remove(e);a:{switch(c){case w:case y:case A:case C:b=!0;break a}b=!1}b||oa(a,c,f);a.removeEventListener(c,f.handler,d);delete f}}else console.error("removePointerListener no listener")};f.addPointerListener=function(a,c,b,d){if(c)if(b){var e=b;s.isFunction(b)||
(e=b.handleEvent,s.isFunction(e)&&(e=e.bind(b)));if(-1!==S(a,c,b))console.error("addPointerListener binding already existing");else{b.__event_listeners||(b.__event_listeners=[]);var f={target:a,type:c,listener:b};b.__event_listeners.push(f);!ia(a,c,e,f)&&!pa(a,c,e,f)&&(f.handler=e);a.addEventListener(c,f.handler,d)}}else console.error("addPointerListener no listener")};f.PointerTypes=o;f.POINTER_START=w;f.POINTER_MOVE=y;f.POINTER_END=A;f.POINTER_CANCEL=C;var l,h,i,g={},j=["gesturestart","gesturechange",
"gestureend"];document.createElement("div");for(var K=0;K<j.length;K++){var D=j[K],D="on"+D,P=D in s.vsTestElem;P||(s.vsTestElem.setAttribute(D,"return;"),P="function"==typeof s.vsTestElem[D]);g[j[K]]=P}g.gestures=g.gesturestart&&g.gesturechange&&g.gestureend;"MSGestureEvent"in window&&(g.msGestures=!0);g.gestures=!1;g.msGestures=!1;var W=0,X=0,r,N,t=function(a,c){var b=c?void 0:V(a.targetPointerList);return{scale:c?void 0:T(a.targetPointerList[0],a.targetPointerList[1])/W,rotation:c?void 0:U(a.targetPointerList[0],
a.targetPointerList[1])-X,translation:c?void 0:[b.x-r.x,b.y-r.y],nbPointers:a.nbPointers,pointerList:a.pointerList,targetPointerList:a.targetPointerList,centroid:b,changedPointerList:a.changedPointerList}},L=!1,ka=function(a){2>a.targetPointerList.length||(a.preventDefault(),L?n(h,a.target,t(a)):(W=T(a.targetPointerList[0],a.targetPointerList[1]),X=U(a.targetPointerList[0],a.targetPointerList[1]),N=s.getElementAbsolutePosition(a.targetPointerList[0].target,!0),r=V(a.targetPointerList),document.addEventListener(f.POINTER_MOVE,
Q),document.addEventListener(f.POINTER_END,u),document.addEventListener(f.POINTER_CANCEL,u),n(l,a.target,t(a)),L=!0))},Q=function(a){a.preventDefault();z(a,function(a){2>a.targetPointerList.length?(document.removeEventListener(f.POINTER_MOVE,Q),document.removeEventListener(f.POINTER_END,u),document.removeEventListener(f.POINTER_CANCEL,u),L=!1,n(i,a.target,t(a,!0))):n(h,a.target,t(a))})},u=function(a){a.preventDefault();B(a,function(a){2>a.targetPointerList.length?(document.removeEventListener(f.POINTER_MOVE,
Q),document.removeEventListener(f.POINTER_END,u),document.removeEventListener(f.POINTER_CANCEL,u),L=!1,n(i,a.target,t(a,!0))):n(h,a.target,t(a))})};g.msGestures?(l="MSGestureStart",h="MSGestureChange",i="MSGestureEnd"):g.gestures?(l="gesturestart",h="gesturechange",i="gestureend"):(l="_gesture_start",h="_gesture_change",i="_gesture_end");var pa=g.gestures||g.msGestures?la:ja,oa=g.gestures||g.msGestures?na:ma;f.GESTURE_START=l;f.GESTURE_CHANGE=h;f.GESTURE_END=i}).call(this);

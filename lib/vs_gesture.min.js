define(["exports","vs_utils"],function(e,t){"use strict";var n=!1,r=window.navigator.pointerEnabled,i=window.navigator.msPointerEnabled;"undefined"!=typeof document&&"createTouch"in document?n=!0:r||i?n=!0:"undefined"!=typeof document&&window.navigator&&window.navigator.userAgent&&(-1===window.navigator.userAgent.indexOf("iPhone")&&-1===window.navigator.userAgent.indexOf("iPad")&&-1===window.navigator.userAgent.indexOf("Android")&&-1===window.navigator.userAgent.indexOf("BlackBerry")||(n=!0)),n?(e.POINTER_START=r?"pointerdown":i?"MSPointerDown":"touchstart",e.POINTER_MOVE=r?"pointermove":i?"MSPointerMove":"touchmove",e.POINTER_END=r?"pointerup":i?"MSPointerUp":"touchend",e.POINTER_CANCEL=r?"pointercancel":i?"MSPointerCancel":"touchcancel"):(e.POINTER_START="mousedown",e.POINTER_MOVE="mousemove",e.POINTER_END="mouseup",e.POINTER_CANCEL=null);var o=31337;class s{constructor(e,t,n,r,i,o){this.configureWithEvent(e,r,i,o),this.type=t,this.identifier=n}configureWithEvent(e,t,n,r){this.pageX=e.pageX,this.pageY=e.pageY,"undefiend"!=typeof t&&(this.clientX=t),"undefiend"!=typeof n&&(this.clientY=n),e.target?this.target=e.target:r&&(this.target=r.target),e.currentTarget?this.currentTarget=e.currentTarget:r&&(this.currentTarget=r.currentTarget)}}var a={TOUCH:2,PEN:3,MOUSE:4},u=[];function c(e,t){var n=[];e.nbPointers=e.touches.length;for(var r=0;r<e.nbPointers;r++){var i=e.touches[r],o=new s(i,a.TOUCH,i.identifier,i.clientX,i.clientY,e);n.push(o)}e.pointerList=n,n=[];for(r=0;r<e.targetTouches.length;r++){i=e.targetTouches[r];if(!t||u[i.identifier]==t){o=new s(i,a.TOUCH,i.identifier,i.clientX,i.clientY,e);n.push(o)}}e.targetPointerList=n,n=[];for(r=0;r<e.changedTouches.length;r++){i=e.changedTouches[r],o=new s(i,a.TOUCH,i.identifier,e.clientX,e.clientY,e);n.push(o)}e.changedPointerList=n}function d(e,t){var n=[];n.push(new s(e,a.MOUSE,o,e.layerX,e.layerY)),t?(e.nbPointers=0,e.pointerList=[],e.targetPointerList=n,e.changedPointerList=n):(e.nbPointers=1,e.pointerList=n,e.targetPointerList=n,e.changedPointerList=[])}var g=[],E=[];function v(e,t,n){var r=[],i=[],o=[],a=e.pointerId,c=g[a];t?(c?(E[a]=c,g[a]=void 0):(c=E[a])||(c=new s(e,e.pointerType,a,e.layerX,e.layerY),E[a]=c),E.forEach(function(e){e&&o.push(e)}),E=[]):c?c.configureWithEvent(e):(c=new s(e,e.pointerType,a,e.layerX,e.layerY),g[a]=c),g.forEach(function(e){e&&(r.push(e),n&&u[e.identifier]!=n||i.push(e))}),e.nbPointers=r.length,e.pointerList=r,e.targetPointerList=i,e.changedPointerList=o}function f(e,t){d(e),t(e)}function l(e,t){d(e),t(e)}function h(e,t){d(e,!0),t(e)}function T(e,t,n){for(var r,i=e.targetTouches.length,o=0;o<i;o++)r=e.targetTouches[o],u[r.identifier]=n;c(e),t(e)}function _(e,t,n){c(e,n),t(e)}function p(e,t){for(var n,r=e.changedTouches.length,i=0;i<r;i++)n=e.changedTouches[i],u[n.identifier]=void 0;c(e),t(e)}function P(e,t){c(e),t(e,t)}var m=0,R=function(e){var t=e.pointerId,n=g[t];n&&(E[n.identifier]=n,g[n.identifier]=void 0),0===--m&&(document.removeEventListener(r?"pointerup":"MSPointerUp",R),document.removeEventListener(r?"pointercancel":"MSPointerCancel",R))};function N(e,t,n){u[e.pointerId]=n,v(e,!1,n),t(e),0===m&&(document.addEventListener(r?"pointerup":"MSPointerUp",R),document.addEventListener(r?"pointercancel":"MSPointerCancel",R)),m++}function O(e,t,n){v(e,!1,n),t(e)}function S(e,t){v(e,!0),t(e)}function w(e,t){v(e,!0),t(e)}var L,A,M,G;n?i?(L=N,A=O,M=S,G=w):(L=T,A=_,M=p,G=P):(L=f,A=l,M=h,G=h);function y(e,t,n){if(!t||!n||!n.__event_listeners)return-1;for(var r=0;r<n.__event_listeners.length;r++){var i=n.__event_listeners[r];if(i.target===e&&i.type===t&&i.listener===n)return r}return-1}function C(t,n,r,i){var o=i.listener?i.listener.id:void 0;switch(o||(o=""+(new Date).getTime()+Math.floor(1e6*Math.random()),i.listener&&(i.listener.id=o)),n){case e.POINTER_START:return i.handler=function(e){L(e,r,o)},!0;case e.POINTER_MOVE:return i.handler=function(e){A(e,r,o)},!0;case e.POINTER_END:return i.handler=function(e){M(e,r)},!0;case e.POINTER_CANCEL:return i.handler=function(e){G(e,r)},!0}return!1}const I={},U=["gesturestart","gesturechange","gestureend"];document.createElement("div");for(var b=0;b<U.length;b++){var D=U[b],X=(D="on"+D)in t.vsTestElem;X||(t.vsTestElem.setAttribute(D,"return;"),X="function"==typeof t.vsTestElem[D]),I[U[b]]=X}I.gestures=I.gesturestart&&I.gesturechange&&I.gestureend,"MSGestureEvent"in window&&(I.msGestures=!0),I.gestures=!1,I.msGestures=!1,I.msGestures?(e.GESTURE_START="MSGestureStart",e.GESTURE_CHANGE="MSGestureChange",e.GESTURE_END="MSGestureEnd"):I.gestures?(e.GESTURE_START="gesturestart",e.GESTURE_CHANGE="gesturechange",e.GESTURE_END="gestureend"):(e.GESTURE_START="_gesture_start",e.GESTURE_CHANGE="_gesture_change",e.GESTURE_END="_gesture_end"),e.createCustomEvent=function(e,t,n){var r=document.createEvent("Event");r.initEvent(e,!0,!0);for(var i in n)r[i]=n[i];t.dispatchEvent(r)},e.removePointerListener=function(t,n,r,i){if(n)if(r){var o=y(t,n,r);if(-1!==o){var s=r.__event_listeners[o];r.__event_listeners.remove(o),function(t,n,r){switch(n){case e.POINTER_START:case e.POINTER_MOVE:case e.POINTER_END:case e.POINTER_CANCEL:return!0}return!1}(0,n)||manageGestureListenerRemove(t,n,s),t.removeEventListener(n,s.handler,i)}else console.error("removePointerListener no binding")}else console.error("removePointerListener no listener")},e.addPointerListener=function(e,n,r,i){if(n)if(r){var o=r;if(t.isFunction(r)||(o=r.handleEvent,t.isFunction(o)&&(o=o.bind(r))),-1===y(e,n,r)){r.__event_listeners||(r.__event_listeners=[]);var s={target:e,type:n,listener:r};r.__event_listeners.push(s),C(0,n,o,s)||manageGestureListenerAdd(e,n,o,s)||(s.handler=o),e.addEventListener(n,s.handler,i)}else console.error("addPointerListener binding already existing")}else console.error("addPointerListener no listener")},e.PointerTypes=a,e.Pointer=s,Object.defineProperty(e,"__esModule",{value:!0})});